; ========================
; ğŸš€ Clash ç»ˆæä¼˜åŒ–ç‰ˆ (blackmatrix7æº)
; è®¾è®¡åŸåˆ™ï¼šæç®€åŒ¹é… | æ™ºèƒ½åˆ†æµ | åŠ¨æ€æ›´æ–°
; æ›´æ–°æ—¶é—´ï¼š2023-10-21
; ========================

; ########################
; ğŸ”„ åŠ¨æ€è§„åˆ™æä¾›è€…ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰
; ########################
rule-providers:
  # æ‹¦æˆªç±»è§„åˆ™
  adblock:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Advertising/Advertising.yaml"
    path: ./rules/adblock.yaml
    interval: 86400  # 24å°æ—¶æ›´æ–°

  # å›½å†…è§„åˆ™
  china:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/China/China.yaml"
    path: ./rules/china.yaml
    interval: 86400

; ########################
; ğŸš¦ æ ¸å¿ƒè§„åˆ™ï¼ˆæŒ‰åŒ¹é…ä¼˜å…ˆçº§æ’åºï¼‰
; ########################
rules:
  # 1. å¼ºåˆ¶æ‹¦æˆªè§„åˆ™ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
  - RULE-SET,adblock,ğŸ›‘ å…¨çƒæ‹¦æˆª
  - DOMAIN,analytics.google.com,ğŸ›‘ å…¨çƒæ‹¦æˆª  # è¡¥å……å¸¸è§è·Ÿè¸ªåŸŸå
  - DOMAIN-KEYWORD,adservice,ğŸ›‘ å…¨çƒæ‹¦æˆª

  # 2. å›½å†…ç›´è¿
  - RULE-SET,china,ğŸ¯ å…¨çƒç›´è¿
  - GEOIP,CN,ğŸ¯ å…¨çƒç›´è¿,no-resolve
  - GEOSITE,CN,ğŸ¯ å…¨çƒç›´è¿
  - GEOSITE,private,ğŸ¯ å…¨çƒç›´è¿  # æœ¬åœ°ç½‘ç»œ
  - DOMAIN-SUFFIX,cn,ğŸ¯ å…¨çƒç›´è¿  # å…œåº•CNåŸŸå

  # 3. å¸¸ç”¨å›½å¤–æœåŠ¡åˆ†æµ
  - GEOSITE,google,ğŸš€ å‡ºå›½ä»£ç†
  - GEOSITE,github,ğŸš€ å‡ºå›½ä»£ç†
  - GEOSITE,netflix,ğŸš€ å‡ºå›½ä»£ç†
  - GEOSITE,openai,ğŸš€ å‡ºå›½ä»£ç†  # AIæœåŠ¡ä¸“ç”¨åˆ†æµ
  - GEOSITE,geolocation-!cn,ğŸš€ å‡ºå›½ä»£ç†  # éä¸­å›½åœ°åŒºåŸŸå

  # 4. æ¸¸æˆå¹³å°ç‰¹æ®Šå¤„ç†
  - DOMAIN-KEYWORD,steam,ğŸš€ å‡ºå›½ä»£ç†
  - DOMAIN-SUFFIX,epicgames.com,ğŸš€ å‡ºå›½ä»£ç†
  - IP-CIDR,192.0.73.0/24,ğŸš€ å‡ºå›½ä»£ç†  # PlayStationç½‘ç»œ

  # 5. æœ€ç»ˆå…œåº•è§„åˆ™
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼

; ########################
; âš¡ ç­–ç•¥ç»„æ™ºèƒ½ä¼˜åŒ–
; ########################
proxy-groups:
  - name: "ğŸš€ å‡ºå›½ä»£ç†"
    type: select
    proxies:
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - DIRECT  # ç›´è¿å¤‡é€‰

  - name: "â™»ï¸ è‡ªåŠ¨é€‰æ‹©"
    type: url-test
    url: "http://www.gstatic.com/generate_204"
    interval: 300  # 10åˆ†é’Ÿæµ‹é€Ÿ
    tolerance: 50  # å»¶è¿Ÿå®¹å·®(ms)
    proxies: $proxy-providers.proxy_auto  # å¼•ç”¨ä»£ç†æä¾›å•†

  - name: "ğŸ¯ å…¨çƒç›´è¿"
    type: select
    proxies:
      - DIRECT

  - name: "ğŸ›‘ å…¨çƒæ‹¦æˆª"
    type: select
    proxies:
      - REJECT
      - DIRECT  # è°ƒè¯•ç”¨å¤‡é€‰

  - name: "ğŸŸ æ¼ç½‘ä¹‹é±¼"
    type: select
    proxies:
      - ğŸš€ å‡ºå›½ä»£ç†
      - ğŸ¯ å…¨çƒç›´è¿

; ########################
; ğŸ› ï¸ é«˜çº§å¼•æ“é…ç½®
; ########################
dns:
  enable: true
  enhanced-mode: fake-ip
  nameserver:
    - 223.5.5.5  # é˜¿é‡ŒDNS
    - 119.29.29.29  # è…¾è®¯DNS
  fallback:
    - tls://8.8.4.4:853  # åŠ å¯†DNS

tun:
  enable: true
  stack: system
  auto-route: true

experimental:
  ignore-resolve-fail: true  # è·³è¿‡è§£æå¤±è´¥åŸŸå
